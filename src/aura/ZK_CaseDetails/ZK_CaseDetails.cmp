<aura:component description="ZK_CaseDetails"
                controller="ZK_SupportController">

    <aura:attribute name="currentUserId" type="Id"/>
    <aura:attribute name="case" type="Object"/>

    <aura:attribute name="comments" type="Object[]"/>

    <aura:attribute name="commentBody" type="String"/>

    <aura:handler name="init" value="{!this}" action="{!c.doInit}"/>

    <div>

        <div>
            <h3> {!$Label.c.ZK_Title_Created_Date + ' ' + v.case.CreatedDate} </h3>
        </div>

        <div class="slds-grid">
            <p> {!v.case.Description} </p>
        </div>

        <div class="slds-m-top_medium slds-grid slds-grid_vertical slds-grid_align-spread messages-box slds-scrollable_y">

            <aura:iteration items="{!v.comments}" var="comment">
                <div style="max-width: 50%"
                     class="{!(comment.CreatedBy.Id == v.currentUserId ?
                             ' slds-col_bump-left slds-grid_reverse' : '') + ' slds-grid slds-m-top_small'}">
                    <lightning:avatar class="message-avatar"
                                      src="{!comment.CreatedBy.CreatedBy.SmallPhotoUrl}"
                                      alternativeText="{!comment.CreatedBy.CreatedBy.Name}"/>

                    <p class="{!(comment.CreatedBy.Id == v.currentUserId ?
                            'my-message slds-m-right_small' : 'other-message slds-m-left_small')
                            + ' slds-p-around_small message'}">
                            {!comment.CommentBody}
                    </p>
                </div>
            </aura:iteration>

        </div>

        <aura:if isTrue="{!v.case.Status != 'Closed'}">

            <div class="slds-grid slds-m-top_medium">
                <div class="slds-size_10-of-12 slds-p-right_small">
                    <lightning:input aura:id="messageInput" type="text" value="{!v.commentBody}" label=""
                                     variant="label-hidden" placeholder="{!$Label.c.ZK_Placeholder_Type_Message}"/>
                </div>
                <lightning:button class="slds-col"
                                  variant="brand"
                                  onclick="{!c.onSendCommentClick}"
                                  label="{!$Label.c.ZK_Button_Send}"/>
            </div>
        </aura:if>
        <aura:if isTrue="{!v.case.Status == 'Closed'}">

            <div class="slds-m-top_medium">
                <h2 class="slds-text-heading_small slds-text-align_center">
                    {!$Label.c.ZK_Title_Case_Closed}
                </h2>
            </div>
        </aura:if>

    </div>

</aura:component>
