<aura:component description="ZK_Product">

    <aura:attribute name="destination" type="String" required="true"/>

    <aura:attribute name="product" type="Product2" required="true"/>
    <aura:attribute name="unitPrice" type="Decimal" required="true"/>

    <aura:attribute name="unitPriceDiscount" type="Decimal" required="true"/>
    <aura:attribute name="discountName" type="Decimal" required="true"/>
    <aura:attribute name="discountType" type="String" required="true"/>
    <aura:attribute name="discountPercent" type="Decimal" required="true"/>
    <aura:attribute name="averageRating" type="Decimal" required="true" default="0"/>

    <aura:attribute name="images" type="String[]" required="true"/>
    <aura:attribute name="currency" type="String" required="true"/>

    <aura:attribute name="image" type="String"/>

    <aura:registerEvent name="ZK_ProductShopped" type="c:ZK_ProductShopped"/>

    <aura:handler name="init" value="{!this}" action="{!c.doInit}"/>

    <div class="slds-size_1-of-1 slds-p-around_small">
        <div class="rounded shadow">
            <div style="{!'background-image: url(\'' + (v.image != null ? v.image : $Resource.ZK_NoPhotoAvailable) + '\');height: 300px'}"
                 class="bg-image slds-is-relative">
                <div style="background-color: rgba(0, 0, 0, 0.8)"
                     class="bg-details rounded-top slds-grid_vertical slds-grid_vertical-align-center">

                    <h3 class="slds-p-top_large color-white slds-text-heading_small slds-text-align_center">
                        Warranty:
                        <span class="text-bold">
                                {!v.product.Warranty_in_Months__c != null ? v.product.Warranty_in_Months__c + ' months' : 'no warranty'}
                        </span>
                    </h3>
                    <h3 class="slds-p-top_x-small color-white slds-text-heading_small slds-text-align_center">
                        Category:
                        <span class="text-bold">
                                {!v.product.Category__c != null ? v.product.Category__c : 'Everything'}
                        </span>
                    </h3>
                    <h3 class="slds-p-top_x-small color-white slds-text-heading_small slds-text-align_center">
                        Code:
                        <span class="text-bold">
                                {!v.product.ProductCode}
                        </span>
                    </h3>

                </div>
            </div>

            <div class="slds-grid slds-grid_vertical-align-end slds-p-around_medium">

                <div class="slds-grid_vertical slds-text-heading_small">

                    <div class="slds-m-vertical_small">
                        <c:ZK_RatingInput rating="{!v.averageRating}" readOnly="{!true}"/>
                    </div>

                    <h2 class="slds-m-bottom_x-small"><a onclick="{!c.goToProduct}"> {!v.product.Name} </a></h2>

                    <aura:if isTrue="{!v.discountPercent != null}">
                        <div>
                            <h4 style="font-weight: bold">
                                <aura:if isTrue="{!v.discountType != 'Single Product'}">
                                    <span class="slds-m-right_x-small"> {!v.discountName} </span>
                                </aura:if>

                                {!v.discountPercent}% OFF!
                            </h4>
                        </div>
                    </aura:if>

                    <span style="{!v.discountPercent != null ? 'text-decoration: line-through' : ''}">
                        <lightning:formattedNumber style="currency" value="{!v.unitPrice}" currencyCode="{!v.currency}"/>
                    </span>

                    <aura:if isTrue="{!v.discountPercent != null}">
                        <span style="color: #29a329;font-weight: bold" class="slds-m-left_small">
                            <lightning:formattedNumber style="currency"
                                                       value="{!v.unitPriceDiscount}"
                                                       currencyCode="{!v.currency}"/>
                        </span>
                    </aura:if>

                </div>
                <div class="slds-col_bump-left">
                    <aura:if isTrue="{!v.destination == 'client'}">
                        <lightning:buttonIcon iconName="utility:cart"
                                              size="large"
                                              variant="brand"
                                              onclick="{!c.onProductShop}"
                                              alternativeText="Add to Cart"/>
                    </aura:if>
                </div>

            </div>

        </div>
    </div>

</aura:component>
